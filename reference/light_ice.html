<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Individual Conditional Expectation (ICE) — light_ice • flashlight</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Individual Conditional Expectation (ICE) — light_ice"><meta property="og:description" content="Generates Individual Conditional Expectation (ICE) profiles.
An ICE profile shows how the prediction of an observation changes if
one or multiple variables are systematically changed across its ranges,
holding all other values fixed (see the reference below for details).
The curves can be centered in order to increase visibility of interaction effects."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flashlight</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/flashlight.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mayer79/flashlight/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Individual Conditional Expectation (ICE)</h1>
    <small class="dont-index">Source: <a href="https://github.com/mayer79/flashlight/blob/HEAD/R/light_ice.R" class="external-link"><code>R/light_ice.R</code></a></small>
    <div class="hidden name"><code>light_ice.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates Individual Conditional Expectation (ICE) profiles.
An ICE profile shows how the prediction of an observation changes if
one or multiple variables are systematically changed across its ranges,
holding all other values fixed (see the reference below for details).
The curves can be centered in order to increase visibility of interaction effects.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">light_ice</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">light_ice</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for flashlight</span></span>
<span><span class="fu">light_ice</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  v <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">data</span>,</span>
<span>  by <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">by</span>,</span>
<span>  evaluate_at <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_bins <span class="op">=</span> <span class="fl">27L</span>,</span>
<span>  cut_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"equal"</span>, <span class="st">"quantile"</span><span class="op">)</span>,</span>
<span>  indices <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_max <span class="op">=</span> <span class="fl">20L</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_linkinv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  center <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"first"</span>, <span class="st">"middle"</span>, <span class="st">"last"</span>, <span class="st">"mean"</span>, <span class="st">"0"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for multiflashlight</span></span>
<span><span class="fu">light_ice</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>An object of class "flashlight" or "multiflashlight".</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>


<dt>v</dt>
<dd><p>The variable name to be profiled.</p></dd>


<dt>data</dt>
<dd><p>An optional <code>data.frame</code>.</p></dd>


<dt>by</dt>
<dd><p>An optional vector of column names used to additionally group the results.</p></dd>


<dt>evaluate_at</dt>
<dd><p>Vector with values of <code>v</code> used to evaluate the profile.</p></dd>


<dt>breaks</dt>
<dd><p>Cut breaks for a numeric <code>v</code>. Used to overwrite automatic
binning via <code>n_bins</code> and <code>cut_type</code>. Ignored if <code>v</code> is not numeric or if <code>grid</code>
or <code>evaluate_at</code> are specified.</p></dd>


<dt>grid</dt>
<dd><p>A <code>data.frame</code> with evaluation grid. For instance, can be generated by
<code><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid()</a></code>.</p></dd>


<dt>n_bins</dt>
<dd><p>Approximate number of unique values to evaluate for numeric <code>v</code>.
Ignored if <code>v</code> is not numeric or if <code>breaks</code>, <code>grid</code> or <code>evaluate_at</code> are specified.</p></dd>


<dt>cut_type</dt>
<dd><p>Should a numeric <code>v</code> be cut into "equal" or "quantile" bins?
Ignored if <code>v</code> is not numeric or if <code>breaks</code>, <code>grid</code> or <code>evaluate_at</code> are specified.</p></dd>


<dt>indices</dt>
<dd><p>A vector of row numbers to consider.</p></dd>


<dt>n_max</dt>
<dd><p>If <code>indices</code> is not given, maximum number of rows to consider.
Will be randomly picked from <code>data</code> if necessary.</p></dd>


<dt>seed</dt>
<dd><p>An integer random seed.</p></dd>


<dt>use_linkinv</dt>
<dd><p>Should retransformation function be applied? Default is <code>TRUE</code>.</p></dd>


<dt>center</dt>
<dd><p>How should curves be centered?</p><ul><li><p>Default is "no".</p></li>
<li><p>Choose "first", "middle", or "last" to 0-center at specific evaluation points.</p></li>
<li><p>Choose "mean" to center all profiles at the within-group means.</p></li>
<li><p>Choose "0" to mean-center curves at 0.</p></li>
</ul></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class "light_ice" with the following elements:</p><ul><li><p><code>data</code> A tibble containing the results. Can be used to build fully customized
visualizations. Column names can be controlled by <code>options(flashlight.column_name)</code>.</p></li>
<li><p><code>by</code> Same as input <code>by</code>.</p></li>
<li><p><code>v</code> The variable(s) evaluated.</p></li>
<li><p><code>center</code> How centering was done.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>There are two ways to specify the variable(s) to be profiled.</p><ol><li><p>Pass the variable name via <code>v</code> and an optional vector with evaluation points
<code>evaluate_at</code> (or <code>breaks</code>). This works for dependence on a single variable.</p></li>
<li><p>More general: Specify any <code>grid</code> as a <code>data.frame</code> with one or
more columns. For instance, it can be generated by a call to <code><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid()</a></code>.</p></li>
</ol><p>The minimum required elements in the (multi-)flashlight are "predict_function",
"model", "linkinv" and "data", where the latest can be passed on the fly.</p>
<p>Which rows in <code>data</code> are profiled? This is specified by <code>indices</code>.
If not given and <code>n_max</code> is smaller than the number of rows in <code>data</code>,
then row indices will be sampled randomly from <code>data</code>.
If the same rows should be used for all flashlights in a multiflashlight,
there are two options: Either pass a <code>seed</code> or a vector of indices used to select rows.
In both cases, <code>data</code> should be the same for all flashlights considered.</p>
    </div>
    <div id="methods-by-class-">
    <h2>Methods (by class)</h2>
    
<ul><li><p><code>light_ice(default)</code>: Default method not implemented yet.</p></li>
<li><p><code>light_ice(flashlight)</code>: ICE profiles for a flashlight object.</p></li>
<li><p><code>light_ice(multiflashlight)</code>: ICE profiles for a multiflashlight object.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Goldstein, A. et al. (2015). Peeking inside the black box: Visualizing statistical
learning with plots of individual conditional expectation.
Journal of Computational and Graphical Statistics, 24:1
&lt;doi.org/10.1080/10618600.2014.907095&gt;.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="light_profile.html">light_profile()</a></code>, <code><a href="plot.light_ice.html">plot.light_ice()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="flashlight.html">flashlight</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">fit</span>, label <span class="op">=</span> <span class="st">"lm"</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">light_ice</span><span class="op">(</span><span class="va">fl</span>, v <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I am an object of class light_ice </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data.frames:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  data </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 60 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       id Species    value label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     8 setosa      5.04 lm   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     8 versicolor  4.31 lm   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     8 virginica   4.01 lm   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>    95 setosa      6.58 lm   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>    95 versicolor  5.86 lm   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>    95 virginica   5.56 lm   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>   128 setosa      7.15 lm   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>   128 versicolor  6.43 lm   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>   128 virginica   6.13 lm   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>   114 setosa      6.93 lm   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 50 more rows</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michael Mayer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

